# Chatç³»ç»Ÿäººå‘˜åˆ†å·¥
ç¼–å†™äººï¼šå æ–‡æ˜Ÿ
æ›´æ–°æ—¶é—´ï¼š2021å¹´12æœˆ5æ—¥

## Chatç³»ç»Ÿé¡¹ç›®æˆªæ­¢æ—¥æœŸï¼š2021å¹´12æœˆ15æ—¥

### è®¾è®¡å®éªŒæŠ¥å‘Šï¼ˆ3ä»½ï¼‰
å æ–‡æ˜Ÿã€ä»»æ¶›ã€è¢å®ä¸š

### ç­”è¾©PPTï¼ˆ1ä»½ï¼‰åˆ†å·¥å¦‚ä¸‹
ä»»æ¶›ã€è¢å®ä¸š

## ä¸»è¦å¼€å‘å·¥ä½œæˆªæ­¢æ—¥æœŸï¼š2021å¹´12æœˆ5æ—¥

### Serverç«¯ç¨‹åºè¿è¡Œæµç¨‹å›¾ï¼ˆğŸ¤”è€ƒè™‘ç»†åŒ–ï¼‰

```mermaid
flowchart TD
    ç¨‹åºå¯åŠ¨-->æ•°æ®åº“é…ç½®
    æ•°æ®åº“é…ç½®-->æ‰‹åŠ¨é…ç½®
    æ•°æ®åº“é…ç½®-->é»˜è®¤é…ç½®
    æ‰‹åŠ¨é…ç½®-->æ•°æ®åº“æµ‹è¯•è¿æ¥
    é»˜è®¤é…ç½®-->æ•°æ®åº“æµ‹è¯•è¿æ¥-->|å¤±è´¥|ç¨‹åºå…³é—­
    æ•°æ®åº“æµ‹è¯•è¿æ¥-->|æˆåŠŸ|å¼€å¯é€‰æ‹©å™¨-->ServerSocketChannelé…ç½®-->èŠå¤©å®¤å¯åŠ¨-->ç›‘å¬é€‰æ‹©å™¨äº‹ä»¶-->è¿æ¥äº‹ä»¶-->SocketChannelé…ç½®-->åˆ é™¤å½“å‰æ´»åŠ¨
    ç›‘å¬é€‰æ‹©å™¨äº‹ä»¶-->å¯è¯»äº‹ä»¶-->è·å–SocketChannel-->|JSON|åå°„åˆ›å»ºç±»è°ƒç”¨æ–¹æ³•
    åå°„åˆ›å»ºç±»è°ƒç”¨æ–¹æ³•-->|JSON|åˆ¤æ–­å‘é€å¯¹è±¡-->|JSON|Client-->åˆ é™¤å½“å‰æ´»åŠ¨-->ç›‘å¬é€‰æ‹©å™¨äº‹ä»¶
```

### Clientç«¯ç¨‹åºè¿è¡Œæµç¨‹å›¾ï¼ˆğŸ¤”è€ƒè™‘é‡æ„ï¼‰
```mermaid
flowchart TD
ç¨‹åºå¯åŠ¨-->æ˜¾ç¤ºHomeä¸»é¡µ
æ˜¾ç¤ºHomeä¸»é¡µ-->|1|æ³¨å†Œç”¨æˆ·-->æ³¨å†Œç”¨æˆ·å-->æ³¨å†Œå¯†ç -->æ³¨å†Œé‚®ç®±-.JSON.->Server-.JSON:Homeå¤±è´¥.->æ˜¾ç¤ºHomeä¸»é¡µ
æ˜¾ç¤ºHomeä¸»é¡µ-->|2|ç™»é™†-->ç™»é™†ç”¨æˆ·å-->ç™»é™†å¯†ç -.JSON.->Server-.JSON:ç™»é™†æˆåŠŸ.->æ˜¾ç¤ºSystemä¸»é¡µ
Server-.JSON:æ³¨å†ŒæˆåŠŸ.->æ˜¾ç¤ºHomeä¸»é¡µ
æ˜¾ç¤ºHomeä¸»é¡µ-->|3|æ‰¾å›å¯†ç -->è¾“å…¥æ‰¾å›å¯†ç çš„ç”¨æˆ·å-->è¾“å…¥æ‰¾å›å¯†ç çš„é‚®ç®±-.JSON.->Server-.JSON:æ‰¾å›æˆåŠŸ.->æ˜¾ç¤ºå¯†ç -->æ˜¾ç¤ºHomeä¸»é¡µ
æ˜¾ç¤ºHomeä¸»é¡µ-->|4|å…³é—­ç¨‹åº
æ˜¾ç¤ºSystemä¸»é¡µ-->|1|æŸ¥è¯¢åœ¨çº¿ç”¨æˆ·-.JSON.->Server-.JSON.->åœ¨çº¿ç»“æœå±•ç¤º-->æ˜¾ç¤ºSystemä¸»é¡µ
æ˜¾ç¤ºSystemä¸»é¡µ-->|2|ç§èŠ-->è¾“å…¥å¯¹æ–¹ç”¨æˆ·å-->è¾“å…¥ç§èŠå†…å®¹-.JSON.->Server
æ˜¾ç¤ºSystemä¸»é¡µ-->|3|ç¾¤èŠ-->è¾“å…¥ç¾¤èŠå†…å®¹-.JSON.->Server
æ˜¾ç¤ºSystemä¸»é¡µ-->|4|ä¿®æ”¹å¯†ç -->è¾“å…¥æ—§å¯†ç -->è¾“å…¥æ–°å¯†ç -.JSON.->Server
æ˜¾ç¤ºSystemä¸»é¡µ-->|5|æ³¨é”€ç”¨æˆ·-->è¾“å…¥å¯†ç -.JSON.->Server
æ˜¾ç¤ºSystemä¸»é¡µ-->|6|é€€å‡º-.JSON.->Server-.JSON:ä¸‹çº¿æˆåŠŸ.->æ˜¾ç¤ºHomeä¸»é¡µ
```

### èŠå¤©åŠŸèƒ½æ—¶åºå›¾
```mermaid
sequenceDiagram
  autonumber
  par ç§èŠæµç¨‹ 1-4
    Client1->>+Server:Client2-ä½ ä»Šå¤©åƒçš„ä»€ä¹ˆï¼Ÿ
    Server-->>-Client2:Client1:ä½ ä»Šå¤©åƒçš„ä»€ä¹ˆï¼Ÿ
    Client2->>+Server:Client1-æ¸…çœŸçš„ç‰›è‚‰æ‹‰é¢
    Server-->>-Client1:Client2:æ¸…çœŸçš„ç‰›è‚‰æ‹‰é¢
  end
  
  par ç¾¤èŠæµç¨‹ 5-16
    Client3->>+Server:All-ç¾¤é‡Œé¢æœ‰äººå—ï¼Ÿ
    Server-->>Client3:ç¾¤èŠ:Client3:ç¾¤é‡Œé¢æœ‰äººå—ï¼Ÿ
    Server-->>Client2:ç¾¤èŠ:Client3:ç¾¤é‡Œé¢æœ‰äººå—ï¼Ÿ
    Server-->>-Client1:ç¾¤èŠ:Client3:ç¾¤é‡Œé¢æœ‰äººå—ï¼Ÿ
    Client1->>+Server:All-æˆ‘åœ¨ç¾¤é‡Œå•Šï¼
    Server-->>Client3:ç¾¤èŠ:Client1:æˆ‘åœ¨ç¾¤é‡Œå•Šï¼
    Server-->>Client2:ç¾¤èŠ:Client1:æˆ‘åœ¨ç¾¤é‡Œå•Šï¼
    Server-->>-Client1:ç¾¤èŠ:Client1:æˆ‘åœ¨ç¾¤é‡Œå•Šï¼
    Client2->>+Server:All-æˆ‘ä¹Ÿåœ¨ç¾¤é‡Œå•Šï¼
    Server-->>Client3:ç¾¤èŠ:Client2:æˆ‘ä¹Ÿåœ¨ç¾¤é‡Œå•Šï¼
    Server-->>Client2:ç¾¤èŠ:Client2:æˆ‘ä¹Ÿåœ¨ç¾¤é‡Œå•Šï¼
    Server-->>-Client1:ç¾¤èŠ:Client2:æˆ‘ä¹Ÿåœ¨ç¾¤é‡Œå•Šï¼
  end

  par æ··åˆæµç¨‹ 18-22
    Client3->>+Server:All-ç¾¤é‡Œé¢æœ‰äººå—ï¼Ÿ
    Server-->>Client3:ç¾¤èŠ:Client3:ç¾¤é‡Œé¢æœ‰äººå—ï¼Ÿ
    Server-->>Client2:ç¾¤èŠ:Client3:ç¾¤é‡Œé¢æœ‰äººå—ï¼Ÿ
    Client2->>+Server:Client1-ä»Šå¤©ä½ æ‰“ç®—å»å“ªé‡Œç©ï¼Ÿ
    Server-->>-Client1:Client2:ä»Šå¤©ä½ æ‰“ç®—å»å“ªé‡Œç©ï¼Ÿ
    Server-->>-Client1:ç¾¤èŠ:Client3:ç¾¤é‡Œé¢æœ‰äººå—ï¼Ÿ
  end
```

### æ•°æ®åº“
#### é»˜è®¤é…ç½®(YAML)
```yaml
database:
  url: 'jdbc:mysql://127.0.0.1:3306/Chat?characterEncoding=UTF-8'
  username: 'root'
  password: '123456'
```

#### USERè¡¨ç»“æ„
|å­—æ®µå|æ•°æ®ç±»å‹|çº¦æŸ|IS NOT NULL|ä¸»é”®|
|:-:|:-:|:-:|:-:|:-:|
|username|varchar(255)|é•¿åº¦1åˆ°10ï¼Œåªæ”¯æŒä¸­æ–‡ã€è‹±æ–‡ã€æ•°å­—ã€ä¸‹åˆ’çº¿|âœ…|âœ…|
|password|varchar(255)|é•¿åº¦6åˆ°18ï¼Œåªæ”¯æŒè‹±æ–‡ã€æ•°å­—ã€ä¸‹åˆ’çº¿|âœ…| |
|email|varchar(255)|emailæ ¼å¼|âœ…| |

### Requestï¼ˆJSONæ ¼å¼å­—ç¬¦ä¸²ï¼‰ å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¼ è¾“å†…å®¹è¦æ±‚

å­—ç¬¦ä¸²ç¤ºä¾‹: {"body":{"password":"test","username":"test"},"head":{"PATH":"Home-login","TOKEN":"<span style="color:red">(username)</span>"}}

#### head

| key | value | è¯´æ˜ |
|:-:|:-:|:-:|
| PATH |Home-login/Clinet|è·¯å¾„ Client-View-Home-Login å–å2ä¸ªåç§° <span style="color:red">è·¯å¾„ä½¿ç”¨å°å†™å‘½å</span>|
|TOKEN|<span style="color:red">(username)</span>|èº«ä»½ æ— å€¼ä¼ ç©º é€šè¿‡ç®—æ³•è¿›è¡Œå¤„ç†|
|TO|username|å‘é€ç”¨æˆ·å|

#### body(æºå¸¦å‚æ•°)

|key|value|
|:-:|:-:|
|request-username|testname|
|request-password|test|
|request-email|test@test.com|
|response-message|"æ“ä½œæˆåŠŸï¼"|

### æºç ï¼ˆ1ä»½ï¼‰åˆ†å·¥å¦‚ä¸‹
#### å æ–‡æ˜Ÿ
æˆªæ­¢å®Œæˆæ—¥æœŸï¼š2021å¹´12æœˆ5æ—¥

|åºå·|å®Œæˆæƒ…å†µ|åŠŸèƒ½æ¨¡å—|æ¨¡å—åç§°|
|:-:|:-:|:-:|:-:|
|1|âœ…|Server-Function-CreateUser|æœåŠ¡ç«¯-åŠŸèƒ½-æ·»åŠ ç”¨æˆ·|
|2|âœ…|Server-Function-SelectUser|æœåŠ¡ç«¯-åŠŸèƒ½-æŸ¥è¯¢ç”¨æˆ·|
|3|âœ…|Server-Function-DeleteUser|æœåŠ¡ç«¯-åŠŸèƒ½-åˆ é™¤ç”¨æˆ·|
|4|âœ…|Server-Function-UpdateUser|æœåŠ¡ç«¯-åŠŸèƒ½-ä¿®æ”¹ç”¨æˆ·|
|5|âœ…|Server-Function-ServerSocketChannel|æœåŠ¡ç«¯-åŠŸèƒ½-æœåŠ¡ç«¯é€šé“|
|6|âœ…|Server-Function-OnlineUser|æœåŠ¡ç«¯-åŠŸèƒ½-åœ¨çº¿ç”¨æˆ·|
|7|âœ…|Server-Function-OneToOne|æœåŠ¡ç«¯-åŠŸèƒ½-ç§èŠ|
|8|âœ…|Server-Function-OneToMore|æœåŠ¡ç«¯-åŠŸèƒ½-ç¾¤èŠ|
|9|âœ…|Server-Fucntion-DataBase-DataManage|æœåŠ¡ç«¯-åŠŸèƒ½-æ•°æ®åº“-æ•°æ®ç®¡ç†|
|10|âœ…|Server-Fucntion-Log|æœåŠ¡ç«¯-åŠŸèƒ½-æ—¥å¿—|


#### ä»»æ¶›
æˆªæ­¢å®Œæˆæ—¥æœŸï¼š2021å¹´12æœˆ5æ—¥

|åºå·|å®Œæˆæƒ…å†µ|åŠŸèƒ½æ¨¡å—|æ¨¡å—åç§°|
|:-:|:-:|:-:|:-:|
|1|âœ…|Client-View-Home-Create|å®¢æˆ·ç«¯-é¦–é¡µ-æ˜¾ç¤º-ç”¨æˆ·æ³¨å†Œ|
|2|âœ…|Client-View-Home-Login|å®¢æˆ·ç«¯-é¦–é¡µ-æ˜¾ç¤º-ç”¨æˆ·ç™»é™†|
|3|âœ…|Client-View-Home-RetrievePassword|å®¢æˆ·ç«¯-é¦–é¡µ-æ˜¾ç¤º-æ‰¾å›å¯†ç |
|4|âœ…|Client-View-Home-Quit|å®¢æˆ·ç«¯-é¦–é¡µ-æ˜¾ç¤º-ç³»ç»Ÿé€€å‡º|
|5|âœ…|Client-Function-Home-Create|å®¢æˆ·ç«¯-é¦–é¡µ-åŠŸèƒ½-ç”¨æˆ·æ³¨å†Œ|
|6|âœ…|Client-Function-Home-Login|å®¢æˆ·ç«¯-é¦–é¡µ-åŠŸèƒ½-ç”¨æˆ·ç™»é™†|
|7|âœ…|Client-Function-Home-RetrievePassword|å®¢æˆ·ç«¯-é¦–é¡µ-åŠŸèƒ½-æ‰¾å›å¯†ç |
|8|âœ…|Client-Function-Home-Quit|å®¢æˆ·ç«¯-é¦–é¡µ-åŠŸèƒ½-ç³»ç»Ÿé€€å‡º|

#### è¢å®ä¸š
å®Œæˆæ—¥æœŸï¼š2021å¹´12æœˆ5æ—¥

|åºå·|å®Œæˆæƒ…å†µ|åŠŸèƒ½æ¨¡å—|æ¨¡å—åç§°|
|:-:|:-:|:-:|:-:|
|1|âœ…|Client-View-System-OnlineUser|å®¢æˆ·ç«¯-ç³»ç»Ÿé¦–é¡µ-æ˜¾ç¤º-åœ¨çº¿äººå‘˜|
|2|âœ…|Client-View-System-OneToOne|å®¢æˆ·ç«¯-ç³»ç»Ÿé¦–é¡µ-æ˜¾ç¤º-ç§èŠ|
|3|âœ…|Client-View-System-OneToMore|å®¢æˆ·ç«¯-ç³»ç»Ÿé¦–é¡µ-æ˜¾ç¤º-ç¾¤èŠ|
|4|âœ…|Client-View-System-DeleteUser|å®¢æˆ·ç«¯-ç³»ç»Ÿé¦–é¡µ-æ˜¾ç¤º-è´¦å·æ³¨é”€|
|5|âœ…|Client-View-System-ChangePassword|å®¢æˆ·ç«¯-ç³»ç»Ÿé¦–é¡µ-æ˜¾ç¤º-è´¦å·å¯†ç ä¿®æ”¹|
|6|âœ…|Client-View-System-Quit|å®¢æˆ·ç«¯-ç³»ç»Ÿé¦–é¡µ-æ˜¾ç¤º-ç³»ç»Ÿé€€å‡º|
|7|âœ…|Client-Function-System-OnlineUser|å®¢æˆ·ç«¯-ç³»ç»Ÿé¦–é¡µ-åŠŸèƒ½-åœ¨çº¿äººå‘˜|
|8|âœ…|Client-Function-System-OneToOne|å®¢æˆ·ç«¯-ç³»ç»Ÿé¦–é¡µ-åŠŸèƒ½-ç§èŠ|
|9|âœ…|Client-Function-System-MoreToMore|å®¢æˆ·ç«¯-ç³»ç»Ÿé¦–é¡µ-åŠŸèƒ½-ç¾¤èŠ|
|10|âœ…|Client-Function-System-DeleteUser|å®¢æˆ·ç«¯-ç³»ç»Ÿé¦–é¡µ-åŠŸèƒ½-è´¦å·æ³¨é”€|
|11|âœ…|Client-Function-System-ChangePassword|å®¢æˆ·ç«¯-ç³»ç»Ÿé¦–é¡µ-åŠŸèƒ½-è´¦å·å¯†ç ä¿®æ”¹|
|12|âœ…|Client-Function-System-Quit|å®¢æˆ·ç«¯-ç³»ç»Ÿé¦–é¡µ-åŠŸèƒ½-ç³»ç»Ÿé€€å‡º|